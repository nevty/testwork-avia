{"version":3,"sources":["img/error_face.svg","img/loading.svg","api/api.js","redux/tickets-reducer.js","Components/Sidebar/Sidebar.js","helpFunctions/convertTime.js","Components/TicketsList/TicketsList.js","hoc/withTicketsFallback.js","common/preloader/preloader.js","Components/TicketsListContainer/TicketsListContainer.js","helpFunctions/throttle.js","App.js","redux/redux-store.js","index.js"],"names":["module","exports","instance","axios","create","baseURL","ticketsAPI","get","id","initialState","tickets","searchId","filteredByStops","sorted","stop","maxSize","ticketsErrorResponse","isFetching","setTicketsCreator","type","setTicketsFetchingCreator","boolean","ticketsReducer","state","action","error","sort","a","b","price","segments","duration","number","Sidebar","handleChange","target","props","setFilterTicketsByStops","value","className","label","map","elem","key","Form","Check","custom","name","onChange","React","Component","connect","ticketsPage","dispatch","setFilterTicketsByStopsActionCreator","convertMinsToHrs","mins","format","h","Math","floor","m","convertToDouble","hours","minutes","countArrivalTime","startDate","newDate","Date","getTime","getHours","getMinutes","TicketsList","ticketsArr","length","filter","ticket","stops","listItem","slice","offset","index","originName","origin","destinationName","destination","originStops","destinationStops","originStopsString","join","destinationStopsString","originFlyDuration","destinationFlyDuration","originLeavingDate","date","destinationLeavingDate","originLeavingTime","destinationLeavingTime","originArrivalDate","destinationArrivalDate","Card","Image","src","carrier","alt","mapStateToPropsForFilter","Preloader","preloader","width","TicketsListContainer","handleScroll","e","main","current","scrollHeight","offsetTop","window","innerHeight","pageYOffset","setState","prevState","ticketsOffest","handleSort","sortTicketsByPrice","sortTicketsByDuration","createRef","this","getTicketsRequest","addEventListener","f","delay","isReady","lastArgs","lastThis","wrapper","args","apply","setTimeout","throttle","ToggleButtonGroup","ToggleButton","variant","ref","compose","then","response","data","async","resolveCounter","errorCounter","searchStop","push","flat","setTicketsErrorResponse","status","FallbackComponent","errorFace","App","reducers","combineReducers","store","createStore","applyMiddleware","ThunkMiddleware","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9281cc50.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/error_face.bc5f6531.svg\";","module.exports = __webpack_public_path__ + \"static/media/loading.dd6c5e8f.svg\";","import axios from \"axios\";\r\n\r\n\r\nconst instance = axios.create({\r\n    baseURL: \"https://front-test.beta.aviasales.ru\",\r\n})\r\n\r\nexport const ticketsAPI = {\r\n    getSearchId(){\r\n        return instance.get('/search');\r\n    },\r\n    getTickets(id){\r\n        return instance.get(`/tickets?searchId=${id}`);\r\n    },\r\n}\r\n\r\n","import {ticketsAPI} from \"../api/api\";\r\n\r\nconst SET_TICKETS = \"SET_TICKETS\";\r\nconst SET_TICKETS_ERROR_RESPONSE = \"SET_TICKETS_ERROR_RESPONSE\";\r\nconst SET_TICKETS_FETCHING = \"SET_TICKETS_FETCHING\";\r\nconst SET_SEARCH_ID = \"SET_SEARCH_ID\";\r\nconst SORT_TICKETS_BY_PRICE = \"SORT_TICKETS_BY_PRICE\";\r\nconst SORT_TICKETS_BY_DURATION = \"SORT_TICKETS_BY_DURATION\";\r\nconst SET_FILTER_TICKETS_BY_STOPS = \"SET_FILTER_TICKETS_BY_STOPS\";\r\n\r\nlet initialState = {\r\n    tickets: [],\r\n    searchId: \"\",\r\n    filteredByStops: \"\",\r\n    sorted: null,\r\n    stop: false,\r\n    maxSize: 10,\r\n    ticketsErrorResponse: null,\r\n    isFetching: false,\r\n}\r\n\r\nconst ticketsReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_TICKETS:\r\n            return {\r\n                ...state,\r\n                tickets: action.tickets\r\n            }\r\n        case SET_TICKETS_ERROR_RESPONSE:\r\n            return {\r\n                ...state,\r\n                ticketsErrorResponse: action.error,\r\n            }\r\n        case SET_TICKETS_FETCHING:\r\n            return {\r\n                ...state,\r\n                isFetching: action.boolean,\r\n            }\r\n\r\n        case SET_SEARCH_ID:\r\n            return {\r\n                ...state,\r\n                searchId: action.id\r\n            }\r\n        case SORT_TICKETS_BY_PRICE:\r\n            return {\r\n                ...state,\r\n                sorted: \"cheap\",\r\n                tickets: state.tickets.sort((a,b)=>{\r\n                    return a.price - b.price;\r\n                })\r\n            }\r\n        case SORT_TICKETS_BY_DURATION:\r\n            return {\r\n                ...state,\r\n                sorted: \"fast\",\r\n                tickets: state.tickets.sort((a,b)=>{\r\n                    return a.segments[0].duration - b.segments[0].duration;\r\n                })\r\n            }\r\n        case SET_FILTER_TICKETS_BY_STOPS:\r\n            return {\r\n                ...state,\r\n                filteredByStops: action.number\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const setTicketsCreator = (tickets) => ({type: SET_TICKETS, tickets});\r\n\r\nexport const setTicketsErrorResponse = (error)=> ({type: SET_TICKETS_ERROR_RESPONSE,error});\r\n\r\nexport const setSearchId = (id) => ({type: SET_SEARCH_ID, id});\r\n\r\nexport const getTicketsRequest = () => (dispatch) => {\r\n        ticketsAPI.getSearchId()\r\n        .then(response=>{\r\n            dispatch(setSearchId(response.data.searchId));\r\n            return response.data.searchId\r\n        })\r\n        .then(id=>{\r\n            dispatch(setTicketsFetchingCreator(true));\r\n            let tickets = [];\r\n            (async (id) => {\r\n                let resolveCounter = 0;\r\n                let errorCounter = 0;\r\n                let searchStop = false;\r\n                while (resolveCounter < 50 && !searchStop && errorCounter < 50) {\r\n                    await ticketsAPI.getTickets(id).then(response=>{\r\n                            tickets.push(response.data.tickets.flat());\r\n                            searchStop = response.data.stop;\r\n                            resolveCounter++;\r\n                        },error=>errorCounter++)\r\n                }\r\n                dispatch(setTicketsCreator(tickets.flat()));\r\n                dispatch(setTicketsFetchingCreator(false));\r\n            })(id)\r\n        },error => {\r\n            dispatch(setTicketsFetchingCreator(false));\r\n            dispatch(setTicketsErrorResponse(error.response.status))\r\n        })\r\n\r\n}\r\n\r\nexport const sortTicketsByPriceActionCreator = ()=>({type:SORT_TICKETS_BY_PRICE});\r\n\r\nexport const sortTicketsByDurationActionCreator = ()=>({type:SORT_TICKETS_BY_DURATION});\r\n\r\nexport const setFilterTicketsByStopsActionCreator = (number)=> ({type:SET_FILTER_TICKETS_BY_STOPS,number});\r\n\r\nexport const setTicketsFetchingCreator = (boolean) => ({type: SET_TICKETS_FETCHING,boolean});\r\n\r\nexport default ticketsReducer;","import React from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    setFilterTicketsByStopsActionCreator,\r\n} from \"../../redux/tickets-reducer\";\r\nimport {Form} from \"react-bootstrap\";\r\n\r\n\r\nclass Sidebar extends React.Component {\r\n\r\n    handleChange = ({target}) => {\r\n        this.props.setFilterTicketsByStops(target.value);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <aside className=\"Tickets__filter text-left p-4 mt-2 shadow-sm bg-white rounded\">\r\n                <h5>КОЛИЧЕСТВО ПЕРЕСАДОК</h5>\r\n                {[\r\n                    {value:\"\",label:\"Все\"},\r\n                    {value:0,label:\"Без персадок\"},\r\n                    {value:1,label:\"1 пересадка\"},\r\n                    {value:2,label:\"2 пересадки\"},\r\n                    {value:3,label:\"3 пересадки\"},].map(elem => (\r\n                    <div key={elem.value}>\r\n                        <Form.Check\r\n                            custom\r\n                            type=\"radio\"\r\n                            name=\"stops\"\r\n                            id={`custom-radio-${elem.value}`}\r\n                            value={elem.value}\r\n                            label={elem.label}\r\n                            onChange={this.handleChange}\r\n                        />\r\n                    </div>\r\n                ))\r\n                }\r\n            </aside>\r\n        )\r\n    }\r\n}\r\n\r\nlet mapStateToProps = (state) => ({\r\n    filteredByStops: state.ticketsPage.filteredByStops,\r\n})\r\n\r\nlet mapDispatchToProps = (dispatch)=>({\r\n    setFilterTicketsByStops: (number)=> {dispatch(setFilterTicketsByStopsActionCreator(number))}\r\n})\r\n\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(Sidebar);","export function convertMinsToHrs(mins,format) {\r\n    let h = (Math.floor(mins / 60));\r\n    let m = mins % 60;\r\n    if (format === \"dotted\") {\r\n        return convertToDouble(h,m);\r\n    }\r\n    if (format === \"hm\") {\r\n        return `${h}ч ${m}м`;\r\n    }\r\n    return `${h}h ${m}m`;\r\n}\r\n\r\nexport function convertToDouble(hours,minutes) {\r\n    hours = hours < 10 ? '0' + hours : hours;\r\n    minutes = minutes < 10 ? '0' + minutes : minutes;\r\n    return `${hours}:${minutes}`;\r\n}\r\n\r\nexport function countArrivalTime(startDate,minutes) {\r\n    let newDate = new Date(startDate.getTime() + minutes * 60000);\r\n    return convertToDouble(newDate.getHours(),newDate.getMinutes())\r\n}\r\n\r\n","import React from \"react\";\r\nimport {Card,Image} from \"react-bootstrap\";\r\nimport {convertMinsToHrs, convertToDouble, countArrivalTime} from \"../../helpFunctions/convertTime\";\r\n\r\nconst TicketsList = (props) => {\r\n\r\n    let ticketsArr = props.tickets;\r\n\r\n    if ((props.filteredByStops !== \"\") && ticketsArr.length) {\r\n        const filteredByStops = +props.filteredByStops;\r\n        ticketsArr = [...props.tickets.filter(ticket => ticket.segments[0].stops.length === filteredByStops && ticket.segments[1].stops.length === filteredByStops)];\r\n        }\r\n\r\n        const listItem = ticketsArr.slice(0,props.offset).map((ticket,index)=>{\r\n        const originName = ticket.segments[0].origin;\r\n        const destinationName = ticket.segments[1].destination;\r\n\r\n        const originStops = ticket.segments[0].stops;\r\n        const destinationStops = ticket.segments[1].stops;\r\n\r\n        const originStopsString = originStops.join(\", \");\r\n        const destinationStopsString = destinationStops.join(\", \");\r\n\r\n        const originFlyDuration = ticket.segments[0].duration;\r\n        const destinationFlyDuration = ticket.segments[1].duration;\r\n\r\n        const originLeavingDate = new Date(ticket.segments[0].date);\r\n        const destinationLeavingDate = new Date(ticket.segments[1].date);\r\n\r\n        const originLeavingTime = convertToDouble(originLeavingDate.getHours(),originLeavingDate.getMinutes());\r\n        const destinationLeavingTime = convertToDouble(destinationLeavingDate.getHours(),destinationLeavingDate.getMinutes());\r\n\r\n        const originArrivalDate = countArrivalTime(originLeavingDate,originFlyDuration);\r\n        const destinationArrivalDate = countArrivalTime(destinationLeavingDate,destinationFlyDuration);\r\n\r\n        return (\r\n            <Card key={index} className=\"mt-4 p-4 shadow-sm\">\r\n                <div className=\"ticket__container\">\r\n                    <div className=\"ticket__head row\">\r\n                        <h3 className=\"ticket__price col-6 text-left text-primary\">{ticket.price}<span className=\"price__currency\"> Р</span></h3>\r\n                        <div className=\"ticket__ship-info col-6 text-right\"><Image src={`http://pics.avs.io/99/36/${ticket.carrier}.png`} className=\"\" alt={ticket.carrier}/></div>\r\n                    </div>\r\n                    <div className=\"ticket__table\">\r\n                        <div className=\"ticket__to row\">\r\n                            <div className=\"table__tr col text-left\">\r\n                                <div className=\"ticket__headline text-secondary text-grey\">\r\n                                    {originName} - {destinationName}\r\n                                </div>\r\n                                <div className=\"table__td\">\r\n                                    {originLeavingTime} - {originArrivalDate}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table__tr col\">\r\n                                <div className=\"ticket__headline text-secondary text-grey\">\r\n                                    В пути\r\n                                </div>\r\n                                <div className=\"table__td\">\r\n                                    {convertMinsToHrs(originFlyDuration,\"hm\")}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table__tr col text-right\">\r\n                                <div className=\"ticket__headline text-secondary text-grey\">\r\n                                    Пересадки: {originStops.length ? originStops.length : \"\"}\r\n                                </div>\r\n                                <div className=\"table__td\">\r\n                                    {originStops.length ? originStopsString : \"Без пересадок\"}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"ticket__back row\">\r\n                            <div className=\"table__tr col text-left\">\r\n                                <div className=\"ticket__headline text-secondary text-grey\">\r\n                                    {destinationName} - {originName}\r\n                                </div>\r\n                                <div className=\"table__td\">\r\n                                    {destinationLeavingTime} - {destinationArrivalDate}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table__tr col\">\r\n                                <div className=\"ticket__headline text-secondary text-grey\">\r\n                                    В пути\r\n                                </div>\r\n                                <div className=\"table__td\">\r\n                                    {convertMinsToHrs(destinationFlyDuration,\"hm\")}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"table__tr col text-right\">\r\n                                <div className=\"ticket__headline text-secondary text-grey\">\r\n                                    Пересадки: {destinationStops.length ? destinationStops.length : \"\"}\r\n                                </div>\r\n                                <div className=\"table__td\">\r\n                                    {destinationStops.length ? destinationStopsString : \"Без пересадок\"}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </Card>\r\n        )\r\n    });\r\n    return (\r\n        <>\r\n            {listItem}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default TicketsList;","import React from 'react'\r\nimport {connect} from \"react-redux\";\r\nimport errorFace from \"../img/error_face.svg\"\r\n\r\nlet mapStateToPropsForFilter = (state)=> ({\r\n    ticketsErrorResponse: state.ticketsPage.ticketsErrorResponse,\r\n})\r\n\r\nexport const withTicketsFallback = (Component)=> {\r\n    class FallbackComponent extends React.Component {\r\n        render() {\r\n            if (this.props.ticketsErrorResponse !== null) {\r\n                return (\r\n                    <div className=\"fallback vh-100 bg-white\">\r\n                        <div className=\"fallback__message\">\r\n                            <img src={errorFace} width=\"60\" alt=\"\"/>\r\n                            <h4>Something went wrong,<br/>\r\n                                Try refresh the page\r\n                            </h4>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n            return <Component {...this.props}/>\r\n        }\r\n    }\r\n    return connect(mapStateToPropsForFilter)(FallbackComponent)\r\n}","import preloader from '../../img/loading.svg';\r\nimport React from 'react'\r\n\r\n\r\nlet Preloader = (props)=> {\r\n    return (\r\n        <div className=\"mt-4 mb-4 bg-white\">\r\n            <img src={preloader} width=\"70\" alt=\"\"/>\r\n        </div>\r\n    )\r\n}\r\nexport default Preloader","import React from \"react\";\r\nimport {ToggleButton, ToggleButtonGroup} from \"react-bootstrap\";\r\nimport {\r\n    getTicketsRequest,\r\n    sortTicketsByPriceActionCreator,\r\n    sortTicketsByDurationActionCreator,\r\n} from \"../../redux/tickets-reducer\";\r\nimport {connect} from \"react-redux\";\r\nimport TicketsList from \"../TicketsList/TicketsList\";\r\nimport {compose} from \"redux\";\r\nimport {withTicketsFallback} from \"../../hoc/withTicketsFallback\";\r\nimport Preloader from \"../../common/preloader/preloader\";\r\nimport {throttle} from \"../../helpFunctions/throttle\"\r\n\r\nclass TicketsListContainer extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            ticketsOffest: this.props.maxSize,\r\n        }\r\n        this.main = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.getTicketsRequest();\r\n        window.addEventListener('scroll', throttle(this.handleScroll, 40))\r\n    }\r\n\r\n    handleScroll = (e) => {\r\n        const main = this.main.current;\r\n        const mainHeight = (main.scrollHeight + main.offsetTop);\r\n        const mainPosition = window.innerHeight + window.pageYOffset;\r\n        if ((mainHeight - mainPosition) === 0) {\r\n            this.setState(prevState=>({ticketsOffest: prevState.ticketsOffest + this.props.maxSize}))\r\n        }\r\n    }\r\n\r\n    handleSort = ({target}) => {\r\n        if (this.props.sorted !== target.value) {\r\n            if (target.value === \"cheap\") {\r\n                this.props.sortTicketsByPrice();\r\n            }\r\n\r\n            if (target.value === \"fast\") {\r\n                this.props.sortTicketsByDuration();\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <ToggleButtonGroup type=\"radio\" name=\"sort\" className=\"shadow-sm w-100\">\r\n                    <ToggleButton variant=\"light\" value=\"cheap\" onChange={this.handleSort}>Самый дешёвый</ToggleButton>\r\n                    <ToggleButton variant=\"light\" value=\"fast\" onChange={this.handleSort}>Самый быстрый</ToggleButton>\r\n                </ToggleButtonGroup>\r\n                <div className=\"Tickets__list\" ref={this.main}>\r\n                    <TicketsList tickets={this.props.tickets} offset={this.state.ticketsOffest} filteredByStops={this.props.filteredByStops} maxSize={this.props.maxSize}/>\r\n                    {(this.props.isFetching) ? <Preloader/> : null}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nlet mapStateToProps = (state) => ({\r\n    tickets: state.ticketsPage.tickets,\r\n    filteredByStops: state.ticketsPage.filteredByStops,\r\n    sorted: state.ticketsPage.sorted,\r\n    maxSize: state.ticketsPage.maxSize,\r\n    isFetching: state.ticketsPage.isFetching,\r\n})\r\n\r\nlet mapDispatchToProps = (dispatch)=>({\r\n    getTicketsRequest: ()=> {dispatch(getTicketsRequest())},\r\n    sortTicketsByPrice: ()=>{dispatch(sortTicketsByPriceActionCreator())},\r\n    sortTicketsByDuration: ()=>{dispatch(sortTicketsByDurationActionCreator())},\r\n})\r\n\r\nexport default compose(\r\n    connect(mapStateToProps,mapDispatchToProps),\r\n    withTicketsFallback,\r\n)(TicketsListContainer);","export function throttle(f, delay) {\r\n    let isReady = true;\r\n    let lastArgs = null;\r\n    let lastThis = null;\r\n    return function wrapper(...args) {\r\n        if (!isReady) {\r\n            lastArgs = args;\r\n            lastThis = this;\r\n            return;\r\n        }\r\n        f.apply(this, args);\r\n        isReady = false;\r\n        lastThis = null;\r\n        lastArgs = null;\r\n        setTimeout(() => {\r\n            isReady = true;\r\n            if (lastArgs) {\r\n                wrapper.apply(lastThis, lastArgs);\r\n            }\r\n        }, delay);\r\n    }\r\n}","import React from 'react';\r\nimport './App.css';\r\nimport Sidebar from \"./Components/Sidebar/Sidebar\";\r\nimport TicketsListContainer from \"./Components/TicketsListContainer/TicketsListContainer\";\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App container-fluid\">\r\n      <div className=\"row limit\">\r\n          <div className=\"col-lg-3\"><Sidebar/></div>\r\n          <div className=\"col-lg-9\"><TicketsListContainer/></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import ticketsReducer from \"./tickets-reducer\";\r\nimport {applyMiddleware, combineReducers, createStore} from \"redux\";\r\nimport ThunkMiddleware from \"redux-thunk\";\r\n\r\n\r\nlet reducers = combineReducers({\r\n    ticketsPage: ticketsReducer,\r\n})\r\n\r\nlet store = createStore(reducers,applyMiddleware(ThunkMiddleware));\r\n\r\nexport default store\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css'\r\nimport App from './App';\r\nimport {Provider} from \"react-redux\";\r\nimport store from \"./redux/redux-store\";\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />        \r\n    </Provider>\r\n    , document.getElementById('root'));\r\n"],"sourceRoot":""}